import { ConditionalInput } from '@useparagon/core/steps/library/conditional';

/**
 * New Record intent type
 */
type MicrosoftDynamicsTriggerRecordCreated = {
  /**
   * Apply field mapping
   *
   * **Example**:
   * ```
   * {{userSettings.MappingInput.objectMapping}}
   * ```
   */
  objectMapping?: string;
} & (
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Opportunity';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Account';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Contact';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Lead';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Call';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Meeting';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Task';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Note';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: '<specified by entity property>';

      /**
       * Entity Name
       * The Entity Set Name of the Object. Use Connect Portal Workflow Settings to allow users to select a Custom Object.
       *
       * **Example**:
       * ```
       * entitysetname
       * ```
       */
      customMdEntityName: string;

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
);

/**
 * Record Updated intent type
 */
type MicrosoftDynamicsTriggerRecordUpdated = {
  /**
   * Apply field mapping
   *
   * **Example**:
   * ```
   * {{userSettings.MappingInput.objectMapping}}
   * ```
   */
  objectMapping?: string;
} & (
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Opportunity';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Account';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Contact';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Lead';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Call';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Meeting';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Task';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: 'Note';

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
  | {
      /**
       * Choose an entity
       *
       */
      mdEntity: '<specified by entity property>';

      /**
       * Entity Name
       * The Entity Set Name of the Object. Use Connect Portal Workflow Settings to allow users to select a Custom Object.
       *
       * **Example**:
       * ```
       * entitysetname
       * ```
       */
      customMdEntityName: string;

      /**
       * Filter search
       * Search for records that match specified filters.
       *
       */
      filterFormula?: ConditionalInput;
    }
);

export type IntentToInputOutput = {
  /**
   * MICROSOFT_DYNAMICS_TRIGGER_RECORD_CREATED
   */
  MICROSOFT_DYNAMICS_TRIGGER_RECORD_CREATED: [
    MicrosoftDynamicsTriggerRecordCreated,
    any,
  ];

  /**
   * MICROSOFT_DYNAMICS_TRIGGER_RECORD_UPDATED
   */
  MICROSOFT_DYNAMICS_TRIGGER_RECORD_UPDATED: [
    MicrosoftDynamicsTriggerRecordUpdated,
    any,
  ];
};
