import { ActionStep, ActionTriggerStep } from '@useparagon/core';
import {
  CustomDropdownField,
  UserDefinedFieldMappingOptions,
} from '@useparagon/core/inputs';
import { IntegrationOptions } from '@useparagon/core/integration';

import { IntentToInputOutput } from './intents';
import { IntentToInputOutput as TriggerIntentToInputOutput } from './triggers';

type IQuickbooksIntegrationUserDefinedInput = {
  id: string;
  title: string;
  required?: boolean;
  tooltip?: string;
} & (
  | {
      type:
        | 'text'
        | 'number'
        | 'email'
        | 'url'
        | 'boolean'
        | 'password'
        | 'vendor'
        | 'account';
    }
  | {
      type: 'custom_dropdown';
      key: string;
      customDropdownOptions?: CustomDropdownField[];
    }
  | ({
      type: 'field_mapping';
    } & UserDefinedFieldMappingOptions)
);

/**
 * map b/w input type to result
 */
export type InputResultMap = {
  email: string;
  url: string;
  password: string;
  boolean: boolean;
  text: string;
  number: number;
  custom_dropdown: string;

  vendor: string;
  account: string;
  field_mapping: {
    record_type: string;
    fields: Record<string, any>;
  };
};

/**
 * pass { variableName for input => Input }
 * this should be used whenever we are creating inputs for integrations/workflows
 * as it will infer proper types
 */
export declare const createInputs: <
  T extends Record<string, IQuickbooksIntegrationUserDefinedInput>,
>(
  inputs: T,
) => T;

/**
 * integration type for quickbooks
 */
export type IQuickbooksIntegration = {
  /**
   * name of integration
   */
  name: string;

  /**
   * action step methods
   */
  actions: {
    /**
     * Get accounts
     * method for QUICKBOOKS_GET_ACCOUNTS
     */
    getAccounts: (
      inputs: IntentToInputOutput['QUICKBOOKS_GET_ACCOUNTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_GET_ACCOUNTS'][0],
      IntentToInputOutput['QUICKBOOKS_GET_ACCOUNTS'][1]
    >;

    /**
     * Get customers
     * method for QUICKBOOKS_GET_CUSTOMERS
     */
    getCustomers: (
      inputs: IntentToInputOutput['QUICKBOOKS_GET_CUSTOMERS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_GET_CUSTOMERS'][0],
      IntentToInputOutput['QUICKBOOKS_GET_CUSTOMERS'][1]
    >;

    /**
     * Create customer
     * method for QUICKBOOKS_CREATE_CUSTOMER
     */
    createCustomer: (
      inputs: IntentToInputOutput['QUICKBOOKS_CREATE_CUSTOMER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_CREATE_CUSTOMER'][0],
      IntentToInputOutput['QUICKBOOKS_CREATE_CUSTOMER'][1]
    >;

    /**
     * Update customer
     * method for QUICKBOOKS_UPDATE_CUSTOMER
     */
    updateCustomer: (
      inputs: IntentToInputOutput['QUICKBOOKS_UPDATE_CUSTOMER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_UPDATE_CUSTOMER'][0],
      IntentToInputOutput['QUICKBOOKS_UPDATE_CUSTOMER'][1]
    >;

    /**
     * Get invoices
     * method for QUICKBOOKS_GET_INVOICES
     */
    getInvoices: (
      inputs: IntentToInputOutput['QUICKBOOKS_GET_INVOICES'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_GET_INVOICES'][0],
      IntentToInputOutput['QUICKBOOKS_GET_INVOICES'][1]
    >;

    /**
     * Create invoice
     * method for QUICKBOOKS_CREATE_INVOICE
     */
    createInvoice: (
      inputs: IntentToInputOutput['QUICKBOOKS_CREATE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_CREATE_INVOICE'][0],
      IntentToInputOutput['QUICKBOOKS_CREATE_INVOICE'][1]
    >;

    /**
     * Update invoice
     * method for QUICKBOOKS_UPDATE_INVOICE
     */
    updateInvoice: (
      inputs: IntentToInputOutput['QUICKBOOKS_UPDATE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_UPDATE_INVOICE'][0],
      IntentToInputOutput['QUICKBOOKS_UPDATE_INVOICE'][1]
    >;

    /**
     * Send invoice
     * method for QUICKBOOKS_SEND_INVOICE
     */
    sendInvoice: (
      inputs: IntentToInputOutput['QUICKBOOKS_SEND_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_SEND_INVOICE'][0],
      IntentToInputOutput['QUICKBOOKS_SEND_INVOICE'][1]
    >;

    /**
     * Get payments
     * method for QUICKBOOKS_GET_PAYMENTS
     */
    getPayments: (
      inputs: IntentToInputOutput['QUICKBOOKS_GET_PAYMENTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_GET_PAYMENTS'][0],
      IntentToInputOutput['QUICKBOOKS_GET_PAYMENTS'][1]
    >;

    /**
     * Create payments
     * method for QUICKBOOKS_CREATE_PAYMENT
     */
    createPayment: (
      inputs: IntentToInputOutput['QUICKBOOKS_CREATE_PAYMENT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['QUICKBOOKS_CREATE_PAYMENT'][0],
      IntentToInputOutput['QUICKBOOKS_CREATE_PAYMENT'][1]
    >;
  };

  /**
   * trigger step methods
   */
  triggers: {
    /**
     * New Account
     * method for QUICKBOOKS_TRIGGER_ACCOUNT_CREATED
     */
    accountCreated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_ACCOUNT_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_ACCOUNT_CREATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_ACCOUNT_CREATED'][1]
    >;

    /**
     * New Customer
     * method for QUICKBOOKS_TRIGGER_CUSTOMER_CREATED
     */
    customerCreated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_CUSTOMER_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_CUSTOMER_CREATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_CUSTOMER_CREATED'][1]
    >;

    /**
     * Customer Updated
     * method for QUICKBOOKS_TRIGGER_CUSTOMER_UPDATED
     */
    customerUpdated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_CUSTOMER_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_CUSTOMER_UPDATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_CUSTOMER_UPDATED'][1]
    >;

    /**
     * New Invoice
     * method for QUICKBOOKS_TRIGGER_INVOICE_CREATED
     */
    invoiceCreated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_INVOICE_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_INVOICE_CREATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_INVOICE_CREATED'][1]
    >;

    /**
     * Invoice Updated
     * method for QUICKBOOKS_TRIGGER_INVOICE_UPDATED
     */
    invoiceUpdated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_INVOICE_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_INVOICE_UPDATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_INVOICE_UPDATED'][1]
    >;

    /**
     * New Purchase
     * method for QUICKBOOKS_TRIGGER_PURCHASE_CREATED
     */
    purchaseCreated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_PURCHASE_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_PURCHASE_CREATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_PURCHASE_CREATED'][1]
    >;

    /**
     * Updated Purchase
     * method for QUICKBOOKS_TRIGGER_PURCHASE_UPDATED
     */
    purchaseUpdated: (
      inputs: TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_PURCHASE_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_PURCHASE_UPDATED'][0],
      TriggerIntentToInputOutput['QUICKBOOKS_TRIGGER_PURCHASE_UPDATED'][1]
    >;
  };
};
