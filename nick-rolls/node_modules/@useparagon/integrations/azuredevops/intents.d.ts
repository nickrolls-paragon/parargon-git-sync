import { ConditionalInput } from '@useparagon/core/steps/library/conditional';

/**
 * Search Work Items intent type
 */
type AzureDevopsSearchWorkitems = {
  /**
   * Filter search
   * Search for work items that match specified filters.
   *
   * **Example**:
   * ```
   * field
   * ```
   */
  projectFilterFormula?: ConditionalInput;
};

/**
 * Create Work Item intent type
 */
type AzureDevopsCreateWorkitem = {
  /**
   * Project
   * Specify a project to create this work item for. Use Connect Portal Workflow Settings to allow your user to select a Project.
   *
   * **Example**:
   * ```
   * {{settings.project}}
   * ```
   */
  project: string;

  /**
   * Title
   *
   */
  title: string;

  /**
   * Assignee
   * Specify a user that this work item should be assigned to.
   *
   */
  assignee?: string;

  /**
   * State
   * The state of the created work item.
   *
   */
  state?: 'New' | 'Active' | 'Resolved' | 'Closed';

  /**
   * Reason
   * The reason for the created work item. This value may accept different values depending on the current State of the work item.
   *
   */
  reason?: string;

  /**
   * Area
   * The area for the created work item. Use Connect Portal Workflow Settings to allow users to select an area path.
   *
   */
  area?: string;

  /**
   * Iteration
   * The iteration for the created work item. Use Connect Portal Workflow Settings to allow users to select an iteration path.
   *
   */
  iteration?: string;

  /**
   * Additional Fields
   *
   * **Example**:
   * ```
   *
   *{
   *  "Custom.customfield": "Value for custom field"
   *}
   * ```
   */
  additionalFields?: string;
};

/**
 * Update Work Item intent type
 */
type AzureDevopsUpdateWorkitem = {
  /**
   * Project
   * Specify a project to update this work item in. Use Connect Portal Workflow Settings to allow your user to select a Project.
   *
   * **Example**:
   * ```
   * {{settings.project}}
   * ```
   */
  project: string;

  /**
   * Work Item ID
   * The ID of the work item to update.
   *
   */
  workItemId: string;

  /**
   * Title
   *
   */
  title?: string;

  /**
   * Assignee
   * Specify a user that this work item should be assigned to.
   *
   */
  assignee?: string;

  /**
   * State
   * The state of the created work item.
   *
   */
  state?: 'New' | 'Active' | 'Resolved' | 'Closed';

  /**
   * Reason
   * The reason for the created work item. This value may accept different values depending on the current State of the work item.
   *
   */
  reason?: string;

  /**
   * Area
   * The area for the created work item. Use Connect Portal Workflow Settings to allow users to select an area path.
   *
   */
  area?: string;

  /**
   * Iteration
   * The iteration for the created work item. Use Connect Portal Workflow Settings to allow users to select an iteration path.
   *
   */
  iteration?: string;

  /**
   * Additional Fields
   * Specify any additional fields that should be created with this work item as JSON.
   *
   * **Example**:
   * ```
   *
   *{
   *  "Custom.customfield": "Value for custom field"
   *}
   * ```
   */
  additionalFields?: string;
};

/**
 * Delete Work Item intent type
 */
type AzureDevopsDeleteWorkitem = {
  /**
   * Project
   * Specify a project to delete this work item from. Use Connect Portal Workflow Settings to allow your user to select a Project.
   *
   * **Example**:
   * ```
   * {{settings.project}}
   * ```
   */
  project: string;

  /**
   * Work Item ID
   * The ID of the work item to delete.
   *
   */
  workItemId: string;
};

export type IntentToInputOutput = {
  /**
   * AZURE_DEVOPS_SEARCH_WORKITEMS
   */
  AZURE_DEVOPS_SEARCH_WORKITEMS: [AzureDevopsSearchWorkitems, any];

  /**
   * AZURE_DEVOPS_CREATE_WORKITEM
   */
  AZURE_DEVOPS_CREATE_WORKITEM: [AzureDevopsCreateWorkitem, any];

  /**
   * AZURE_DEVOPS_UPDATE_WORKITEM
   */
  AZURE_DEVOPS_UPDATE_WORKITEM: [AzureDevopsUpdateWorkitem, any];

  /**
   * AZURE_DEVOPS_DELETE_WORKITEM
   */
  AZURE_DEVOPS_DELETE_WORKITEM: [AzureDevopsDeleteWorkitem, any];
};
