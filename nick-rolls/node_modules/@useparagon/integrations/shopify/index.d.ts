import { ActionStep, ActionTriggerStep } from '@useparagon/core';
import {
  CustomDropdownField,
  DynamicMappingField,
} from '@useparagon/core/inputs';
import { IntegrationOptions } from '@useparagon/core/integration';

import { IntentToInputOutput } from './intents';
import { IntentToInputOutput as TriggerIntentToInputOutput } from './triggers';

type IShopifyIntegrationUserDefinedInput = {
  id: string;
  title: string;
  required?: boolean;
  tooltip?: string;
} & (
  | {
      type:
        | 'text'
        | 'number'
        | 'email'
        | 'url'
        | 'boolean'
        | 'password'
        | 'customer_property';
    }
  | {
      type: 'custom_dropdown';
      key: string;
      customDropdownOptions?: CustomDropdownField[];
    }
  | {
      type: 'custom_field_mapping';
      objectName: string;
      // these object types values will be used in preview portal
      mockObjectTypes?: DynamicMappingField[];
      // these integration fields values will be used in preview portal
      mockIntegrationFields?: DynamicMappingField[];
    }
);

/**
 * map b/w input type to result
 */
export type InputResultMap = {
  email: string;
  url: string;
  password: string;
  boolean: boolean;
  text: string;
  number: number;
  custom_dropdown: string;
  custom_field_mapping: {
    object: string;
    fields: Record<string, any>;
  };
  customer_property: string;
};

/**
 * pass { variableName for input => Input }
 * this should be used whenever we are creating inputs for integrations/workflows
 * as it will infer proper types
 */
export declare const createInputs: <
  T extends Record<string, IShopifyIntegrationUserDefinedInput>,
>(
  inputs: T,
) => T;

/**
 * integration type for shopify
 */
export type IShopifyIntegration = {
  /**
   * name of integration
   */
  name: string;

  /**
   * action step methods
   */
  actions: {
    /**
     * Get Customers
     * method for SHOPIFY_GET_CUSTOMERS
     */
    getCustomers: (
      inputs: IntentToInputOutput['SHOPIFY_GET_CUSTOMERS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_CUSTOMERS'][0],
      IntentToInputOutput['SHOPIFY_GET_CUSTOMERS'][1]
    >;

    /**
     * Search Customers
     * method for SHOPIFY_SEARCH_CUSTOMERS
     */
    searchCustomers: (
      inputs: IntentToInputOutput['SHOPIFY_SEARCH_CUSTOMERS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_SEARCH_CUSTOMERS'][0],
      IntentToInputOutput['SHOPIFY_SEARCH_CUSTOMERS'][1]
    >;

    /**
     * Create Customer
     * method for SHOPIFY_CREATE_CUSTOMER
     */
    createCustomer: (
      inputs: IntentToInputOutput['SHOPIFY_CREATE_CUSTOMER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_CREATE_CUSTOMER'][0],
      IntentToInputOutput['SHOPIFY_CREATE_CUSTOMER'][1]
    >;

    /**
     * Update Customer
     * method for SHOPIFY_UPDATE_CUSTOMER
     */
    updateCustomer: (
      inputs: IntentToInputOutput['SHOPIFY_UPDATE_CUSTOMER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_UPDATE_CUSTOMER'][0],
      IntentToInputOutput['SHOPIFY_UPDATE_CUSTOMER'][1]
    >;

    /**
     * Create Customer (GraphQL)
     * method for SHOPIFY_CREATE_CUSTOMER_GRAPHQL
     */
    createCustomerGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_CREATE_CUSTOMER_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_CREATE_CUSTOMER_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_CREATE_CUSTOMER_GRAPHQL'][1]
    >;

    /**
     * Update Customer (GraphQL)
     * method for SHOPIFY_UPDATE_CUSTOMER_GRAPHQL
     */
    updateCustomerGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_UPDATE_CUSTOMER_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_UPDATE_CUSTOMER_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_UPDATE_CUSTOMER_GRAPHQL'][1]
    >;

    /**
     * Get Customers (GraphQL)
     * method for SHOPIFY_GET_CUSTOMERS_GRAPHQL
     */
    getCustomersGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_GET_CUSTOMERS_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_CUSTOMERS_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_GET_CUSTOMERS_GRAPHQL'][1]
    >;

    /**
     * Get Orders
     * method for SHOPIFY_GET_ORDERS
     */
    getOrders: (
      inputs: IntentToInputOutput['SHOPIFY_GET_ORDERS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_ORDERS'][0],
      IntentToInputOutput['SHOPIFY_GET_ORDERS'][1]
    >;

    /**
     * Create Order
     * method for SHOPIFY_CREATE_ORDER
     */
    createOrder: (
      inputs: IntentToInputOutput['SHOPIFY_CREATE_ORDER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_CREATE_ORDER'][0],
      IntentToInputOutput['SHOPIFY_CREATE_ORDER'][1]
    >;

    /**
     * Update Order
     * method for SHOPIFY_UPDATE_ORDER
     */
    updateOrder: (
      inputs: IntentToInputOutput['SHOPIFY_UPDATE_ORDER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_UPDATE_ORDER'][0],
      IntentToInputOutput['SHOPIFY_UPDATE_ORDER'][1]
    >;

    /**
     * Get Abandoned Carts
     * method for SHOPIFY_GET_ABANDONED_CARTS
     */
    getAbandonedCarts: (
      inputs: IntentToInputOutput['SHOPIFY_GET_ABANDONED_CARTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_ABANDONED_CARTS'][0],
      IntentToInputOutput['SHOPIFY_GET_ABANDONED_CARTS'][1]
    >;

    /**
     * Create Order (GraphQL)
     * method for SHOPIFY_CREATE_ORDER_GRAPHQL
     */
    createOrderGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_CREATE_ORDER_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_CREATE_ORDER_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_CREATE_ORDER_GRAPHQL'][1]
    >;

    /**
     * Update Order (GraphQL)
     * method for SHOPIFY_UPDATE_ORDER_GRAPHQL
     */
    updateOrderGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_UPDATE_ORDER_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_UPDATE_ORDER_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_UPDATE_ORDER_GRAPHQL'][1]
    >;

    /**
     * Get Orders (GraphQL)
     * method for SHOPIFY_GET_ORDERS_GRAPHQL
     */
    getOrdersGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_GET_ORDERS_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_ORDERS_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_GET_ORDERS_GRAPHQL'][1]
    >;

    /**
     * Get Abandoned Carts (GraphQL)
     * method for SHOPIFY_GET_ABANDONED_CARTS_GRAPHQL
     */
    getAbandonedCartsGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_GET_ABANDONED_CARTS_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_ABANDONED_CARTS_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_GET_ABANDONED_CARTS_GRAPHQL'][1]
    >;

    /**
     * Get Products
     * method for SHOPIFY_GET_PRODUCTS
     */
    getProducts: (
      inputs: IntentToInputOutput['SHOPIFY_GET_PRODUCTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_PRODUCTS'][0],
      IntentToInputOutput['SHOPIFY_GET_PRODUCTS'][1]
    >;

    /**
     * Create Product
     * method for SHOPIFY_CREATE_PRODUCT
     */
    createProduct: (
      inputs: IntentToInputOutput['SHOPIFY_CREATE_PRODUCT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_CREATE_PRODUCT'][0],
      IntentToInputOutput['SHOPIFY_CREATE_PRODUCT'][1]
    >;

    /**
     * Update Product
     * method for SHOPIFY_UPDATE_PRODUCT
     */
    updateProduct: (
      inputs: IntentToInputOutput['SHOPIFY_UPDATE_PRODUCT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_UPDATE_PRODUCT'][0],
      IntentToInputOutput['SHOPIFY_UPDATE_PRODUCT'][1]
    >;

    /**
     * Create Product (GraphQL)
     * method for SHOPIFY_CREATE_PRODUCT_GRAPHQL
     */
    createProductGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_CREATE_PRODUCT_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_CREATE_PRODUCT_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_CREATE_PRODUCT_GRAPHQL'][1]
    >;

    /**
     * Update Product (GraphQL)
     * method for SHOPIFY_UPDATE_PRODUCT_GRAPHQL
     */
    updateProductGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_UPDATE_PRODUCT_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_UPDATE_PRODUCT_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_UPDATE_PRODUCT_GRAPHQL'][1]
    >;

    /**
     * Get Products (GraphQL)
     * method for SHOPIFY_GET_PRODUCTS_GRAPHQL
     */
    getProductsGraphql: (
      inputs: IntentToInputOutput['SHOPIFY_GET_PRODUCTS_GRAPHQL'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['SHOPIFY_GET_PRODUCTS_GRAPHQL'][0],
      IntentToInputOutput['SHOPIFY_GET_PRODUCTS_GRAPHQL'][1]
    >;
  };

  /**
   * trigger step methods
   */
  triggers: {
    /**
     * New Order
     * method for SHOPIFY_TRIGGER_ORDER_CREATED
     */
    orderCreated: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_CREATED'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_CREATED'][1]
    >;

    /**
     * Order Updated
     * method for SHOPIFY_TRIGGER_ORDER_UPDATED
     */
    orderUpdated: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_UPDATED'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_UPDATED'][1]
    >;

    /**
     * New Order (GraphQL)
     * method for SHOPIFY_TRIGGER_ORDER_CREATED_GRAPHQL
     */
    orderCreatedGraphql: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_CREATED_GRAPHQL'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_CREATED_GRAPHQL'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_CREATED_GRAPHQL'][1]
    >;

    /**
     * Order Updated (GraphQL)
     * method for SHOPIFY_TRIGGER_ORDER_UPDATED_GRAPHQL
     */
    orderUpdatedGraphql: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_UPDATED_GRAPHQL'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_UPDATED_GRAPHQL'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_ORDER_UPDATED_GRAPHQL'][1]
    >;

    /**
     * New Customer
     * method for SHOPIFY_TRIGGER_CUSTOMER_CREATED
     */
    customerCreated: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_CREATED'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_CREATED'][1]
    >;

    /**
     * Customer Updated
     * method for SHOPIFY_TRIGGER_CUSTOMER_UPDATED
     */
    customerUpdated: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_UPDATED'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_UPDATED'][1]
    >;

    /**
     * New Customer (GraphQL)
     * method for SHOPIFY_TRIGGER_CUSTOMER_CREATED_GRAPHQL
     */
    customerCreatedGraphql: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_CREATED_GRAPHQL'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_CREATED_GRAPHQL'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_CREATED_GRAPHQL'][1]
    >;

    /**
     * Customer Updated (GraphQL)
     * method for SHOPIFY_TRIGGER_CUSTOMER_UPDATED_GRAPHQL
     */
    customerUpdatedGraphql: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_UPDATED_GRAPHQL'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_UPDATED_GRAPHQL'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_UPDATED_GRAPHQL'][1]
    >;

    /**
     * New Product (GraphQL)
     * method for SHOPIFY_TRIGGER_PRODUCT_CREATED_GRAPHQL
     */
    productCreatedGraphql: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_CREATED_GRAPHQL'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_CREATED_GRAPHQL'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_CREATED_GRAPHQL'][1]
    >;

    /**
     * New Product
     * method for SHOPIFY_TRIGGER_PRODUCT_CREATED
     */
    productCreated: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_CREATED'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_CREATED'][1]
    >;

    /**
     * Product Updated (GraphQL)
     * method for SHOPIFY_TRIGGER_PRODUCT_UPDATED_GRAPHQL
     */
    productUpdatedGraphql: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_UPDATED_GRAPHQL'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_UPDATED_GRAPHQL'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_UPDATED_GRAPHQL'][1]
    >;

    /**
     * Product Updated
     * method for SHOPIFY_TRIGGER_PRODUCT_UPDATED
     */
    productUpdated: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_UPDATED'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_PRODUCT_UPDATED'][1]
    >;

    /**
     * Customer Data Request
     * method for SHOPIFY_TRIGGER_CUSTOMER_DATA_REQUEST
     */
    customerDataRequest: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_DATA_REQUEST'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_DATA_REQUEST'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_DATA_REQUEST'][1]
    >;

    /**
     * Customer Data Erasure Request
     * method for SHOPIFY_TRIGGER_CUSTOMER_DATA_ERASURE_REQUEST
     */
    customerDataErasureRequest: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_DATA_ERASURE_REQUEST'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_DATA_ERASURE_REQUEST'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_CUSTOMER_DATA_ERASURE_REQUEST'][1]
    >;

    /**
     * Shop Data Erasure Request
     * method for SHOPIFY_TRIGGER_SHOP_DATA_ERASURE_REQUEST
     */
    shopDataErasureRequest: (
      inputs: TriggerIntentToInputOutput['SHOPIFY_TRIGGER_SHOP_DATA_ERASURE_REQUEST'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_SHOP_DATA_ERASURE_REQUEST'][0],
      TriggerIntentToInputOutput['SHOPIFY_TRIGGER_SHOP_DATA_ERASURE_REQUEST'][1]
    >;
  };
};
