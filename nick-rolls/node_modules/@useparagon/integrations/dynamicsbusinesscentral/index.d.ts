import { ActionStep, ActionTriggerStep } from '@useparagon/core';
import {
  CustomDropdownField,
  UserDefinedFieldMappingOptions,
} from '@useparagon/core/inputs';
import { IntegrationOptions } from '@useparagon/core/integration';

import { IntentToInputOutput } from './intents';
import { IntentToInputOutput as TriggerIntentToInputOutput } from './triggers';

type IDynamicsbusinesscentralIntegrationUserDefinedInput = {
  id: string;
  title: string;
  required?: boolean;
  tooltip?: string;
} & (
  | {
      type:
        | 'text'
        | 'number'
        | 'email'
        | 'url'
        | 'boolean'
        | 'password'
        | 'vendors'
        | 'general_ledger_accounts';
    }
  | {
      type: 'custom_dropdown';
      key: string;
      customDropdownOptions?: CustomDropdownField[];
    }
  | ({
      type: 'field_mapping';
    } & UserDefinedFieldMappingOptions)
);

/**
 * map b/w input type to result
 */
export type InputResultMap = {
  email: string;
  url: string;
  password: string;
  boolean: boolean;
  text: string;
  number: number;
  custom_dropdown: string;

  vendors: string;
  general_ledger_accounts: string;
  field_mapping: {
    record_type: string;
    fields: Record<string, any>;
  };
};

/**
 * pass { variableName for input => Input }
 * this should be used whenever we are creating inputs for integrations/workflows
 * as it will infer proper types
 */
export declare const createInputs: <
  T extends Record<string, IDynamicsbusinesscentralIntegrationUserDefinedInput>,
>(
  inputs: T,
) => T;

/**
 * integration type for dynamicsbusinesscentral
 */
export type IDynamicsbusinesscentralIntegration = {
  /**
   * name of integration
   */
  name: string;

  /**
   * action step methods
   */
  actions: {
    /**
     * Create Vendor
     * method for DYNAMICS_BUSINESS_CENTRAL_CREATE_VENDOR
     */
    dynamicsBusinessCentralCreateVendor: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_VENDOR'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_VENDOR'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_VENDOR'][1]
    >;

    /**
     * Update Vendor
     * method for DYNAMICS_BUSINESS_CENTRAL_UPDATE_VENDOR
     */
    dynamicsBusinessCentralUpdateVendor: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_VENDOR'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_VENDOR'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_VENDOR'][1]
    >;

    /**
     * Get Vendor by ID
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_VENDOR_BY_ID
     */
    dynamicsBusinessCentralGetVendorById: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_VENDOR_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_VENDOR_BY_ID'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_VENDOR_BY_ID'][1]
    >;

    /**
     * Search for Vendor
     * method for DYNAMICS_BUSINESS_CENTRAL_SEARCH_VENDOR
     */
    dynamicsBusinessCentralSearchVendor: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_VENDOR'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_VENDOR'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_VENDOR'][1]
    >;

    /**
     * Delete Vendor
     * method for DYNAMICS_BUSINESS_CENTRAL_DELETE_VENDOR
     */
    dynamicsBusinessCentralDeleteVendor: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_VENDOR'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_VENDOR'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_VENDOR'][1]
    >;

    /**
     * Create Purchase Invoice
     * method for DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE
     */
    dynamicsBusinessCentralCreatePurchaseInvoice: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE'][1]
    >;

    /**
     * Update Purchase Invoice
     * method for DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE
     */
    dynamicsBusinessCentralUpdatePurchaseInvoice: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE'][1]
    >;

    /**
     * Post a Purchase Invoice
     * method for DYNAMICS_BUSINESS_CENTRAL_POST_PURCHASE_INVOICE
     */
    dynamicsBusinessCentralPostPurchaseInvoice: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_POST_PURCHASE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_POST_PURCHASE_INVOICE'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_POST_PURCHASE_INVOICE'][1]
    >;

    /**
     * Get Purchase Invoice by ID
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_BY_ID
     */
    dynamicsBusinessCentralGetPurchaseInvoiceById: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_BY_ID'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_BY_ID'][1]
    >;

    /**
     * Search for Purchase Invoice
     * method for DYNAMICS_BUSINESS_CENTRAL_SEARCH_FOR_PURCHASE_INVOICE
     */
    dynamicsBusinessCentralSearchForPurchaseInvoice: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_FOR_PURCHASE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_FOR_PURCHASE_INVOICE'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_FOR_PURCHASE_INVOICE'][1]
    >;

    /**
     * Delete Purchase Invoice
     * method for DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE
     */
    dynamicsBusinessCentralDeletePurchaseInvoice: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE'][1]
    >;

    /**
     * Create Purchase Invoice Line Item
     * method for DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE_LINE_ITEM
     */
    dynamicsBusinessCentralCreatePurchaseInvoiceLineItem: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE_LINE_ITEM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE_LINE_ITEM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PURCHASE_INVOICE_LINE_ITEM'][1]
    >;

    /**
     * Update Purchase Invoice Line Item
     * method for DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE_LINE_ITEM
     */
    dynamicsBusinessCentralUpdatePurchaseInvoiceLineItem: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE_LINE_ITEM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE_LINE_ITEM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PURCHASE_INVOICE_LINE_ITEM'][1]
    >;

    /**
     * Get Purchase Invoice Lines
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINES
     */
    dynamicsBusinessCentralGetPurchaseInvoiceLines: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINES'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINES'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINES'][1]
    >;

    /**
     * Get Purchase Invoice Line Item by ID
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINE_ITEM_BY_ID
     */
    dynamicsBusinessCentralGetPurchaseInvoiceLineItemById: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINE_ITEM_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINE_ITEM_BY_ID'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PURCHASE_INVOICE_LINE_ITEM_BY_ID'][1]
    >;

    /**
     * Search for Purchase Invoice Line Item
     * method for DYNAMICS_BUSINESS_CENTRAL_SEARCH_PURCHASE_INVOICE_LINE_ITEM
     */
    dynamicsBusinessCentralSearchPurchaseInvoiceLineItem: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_PURCHASE_INVOICE_LINE_ITEM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_PURCHASE_INVOICE_LINE_ITEM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_PURCHASE_INVOICE_LINE_ITEM'][1]
    >;

    /**
     * Delete Purchase Invoice Line Item
     * method for DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE_LINE_ITEM
     */
    dynamicsBusinessCentralDeletePurchaseInvoiceLineItem: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE_LINE_ITEM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE_LINE_ITEM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PURCHASE_INVOICE_LINE_ITEM'][1]
    >;

    /**
     * Get Accounts
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNTS
     */
    dynamicsBusinessCentralGetAccounts: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNTS'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNTS'][1]
    >;

    /**
     * Get Account by ID
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNT_BY_ID
     */
    dynamicsBusinessCentralGetAccountById: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNT_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNT_BY_ID'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_ACCOUNT_BY_ID'][1]
    >;

    /**
     * Create Tax Group
     * method for DYNAMICS_BUSINESS_CENTRAL_CREATE_TAX_GROUP
     */
    dynamicsBusinessCentralCreateTaxGroup: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_TAX_GROUP'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_TAX_GROUP'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_TAX_GROUP'][1]
    >;

    /**
     * Update Tax Group
     * method for DYNAMICS_BUSINESS_CENTRAL_UPDATE_TAX_GROUP
     */
    dynamicsBusinessCentralUpdateTaxGroup: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_TAX_GROUP'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_TAX_GROUP'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_TAX_GROUP'][1]
    >;

    /**
     * Get Tax Group by ID
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_TAX_GROUP_BY_ID
     */
    dynamicsBusinessCentralGetTaxGroupById: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_TAX_GROUP_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_TAX_GROUP_BY_ID'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_TAX_GROUP_BY_ID'][1]
    >;

    /**
     * Search for Tax Group
     * method for DYNAMICS_BUSINESS_CENTRAL_SEARCH_TAX_GROUP
     */
    dynamicsBusinessCentralSearchTaxGroup: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_TAX_GROUP'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_TAX_GROUP'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_TAX_GROUP'][1]
    >;

    /**
     * Delete Tax Group
     * method for DYNAMICS_BUSINESS_CENTRAL_DELETE_TAX_GROUP
     */
    dynamicsBusinessCentralDeleteTaxGroup: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_TAX_GROUP'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_TAX_GROUP'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_TAX_GROUP'][1]
    >;

    /**
     * Create Payment Term
     * method for DYNAMICS_BUSINESS_CENTRAL_CREATE_PAYMENT_TERM
     */
    dynamicsBusinessCentralCreatePaymentTerm: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PAYMENT_TERM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PAYMENT_TERM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_CREATE_PAYMENT_TERM'][1]
    >;

    /**
     * Update Payment Term
     * method for DYNAMICS_BUSINESS_CENTRAL_UPDATE_PAYMENT_TERM
     */
    dynamicsBusinessCentralUpdatePaymentTerm: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PAYMENT_TERM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PAYMENT_TERM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_UPDATE_PAYMENT_TERM'][1]
    >;

    /**
     * Get Payment Term by ID
     * method for DYNAMICS_BUSINESS_CENTRAL_GET_PAYMENT_TERM_BY_ID
     */
    dynamicsBusinessCentralGetPaymentTermById: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PAYMENT_TERM_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PAYMENT_TERM_BY_ID'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_GET_PAYMENT_TERM_BY_ID'][1]
    >;

    /**
     * Search for Payment Term
     * method for DYNAMICS_BUSINESS_CENTRAL_SEARCH_PAYMENT_TERM
     */
    dynamicsBusinessCentralSearchPaymentTerm: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_PAYMENT_TERM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_PAYMENT_TERM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_SEARCH_PAYMENT_TERM'][1]
    >;

    /**
     * Delete Payment Term
     * method for DYNAMICS_BUSINESS_CENTRAL_DELETE_PAYMENT_TERM
     */
    dynamicsBusinessCentralDeletePaymentTerm: (
      inputs: IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PAYMENT_TERM'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PAYMENT_TERM'][0],
      IntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_DELETE_PAYMENT_TERM'][1]
    >;
  };

  /**
   * trigger step methods
   */
  triggers: {
    /**
     * Record Created
     * method for DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_CREATED
     */
    dynamicsBusinessCentralTriggerRecordCreated: (
      inputs: TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_CREATED'][0],
      TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_CREATED'][1]
    >;

    /**
     * Record Updated
     * method for DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_UPDATED
     */
    dynamicsBusinessCentralTriggerRecordUpdated: (
      inputs: TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_UPDATED'][0],
      TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_UPDATED'][1]
    >;

    /**
     * Record Deleted
     * method for DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_DELETED
     */
    dynamicsBusinessCentralTriggerRecordDeleted: (
      inputs: TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_DELETED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_DELETED'][0],
      TriggerIntentToInputOutput['DYNAMICS_BUSINESS_CENTRAL_TRIGGER_RECORD_DELETED'][1]
    >;
  };
};
