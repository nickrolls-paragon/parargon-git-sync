import { ActionStep } from '@useparagon/core';
import {
  CustomDropdownField,
  DynamicMappingField,
} from '@useparagon/core/inputs';
import { IntegrationOptions } from '@useparagon/core/integration';

import { IntentToInputOutput } from './intents';

type IFigmaIntegrationUserDefinedInput = {
  id: string;
  title: string;
  required?: boolean;
  tooltip?: string;
} & (
  | {
      type: 'text' | 'number' | 'email' | 'url' | 'boolean' | 'password';
    }
  | {
      type: 'custom_dropdown';
      key: string;
      customDropdownOptions?: CustomDropdownField[];
    }
  | {
      type: 'custom_field_mapping';
      objectName: string;
      // these object types values will be used in preview portal
      mockObjectTypes?: DynamicMappingField[];
      // these integration fields values will be used in preview portal
      mockIntegrationFields?: DynamicMappingField[];
    }
);

/**
 * map b/w input type to result
 */
export type InputResultMap = {
  email: string;
  url: string;
  password: string;
  boolean: boolean;
  text: string;
  number: number;
  custom_dropdown: string;
  custom_field_mapping: {
    object: string;
    fields: Record<string, any>;
  };
};

/**
 * pass { variableName for input => Input }
 * this should be used whenever we are creating inputs for integrations/workflows
 * as it will infer proper types
 */
export declare const createInputs: <
  T extends Record<string, IFigmaIntegrationUserDefinedInput>,
>(
  inputs: T,
) => T;

/**
 * integration type for figma
 */
export type IFigmaIntegration = {
  /**
   * name of integration
   */
  name: string;

  /**
   * action step methods
   */
  actions: {
    /**
     * Get Files by ID
     * method for FIGMA_GET_FILE_BY_ID
     */
    getFileById: (
      inputs: IntentToInputOutput['FIGMA_GET_FILE_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_FILE_BY_ID'][0],
      IntentToInputOutput['FIGMA_GET_FILE_BY_ID'][1]
    >;

    /**
     * Get File Node
     * method for FIGMA_GET_FILE_NODES
     */
    getFileNodes: (
      inputs: IntentToInputOutput['FIGMA_GET_FILE_NODES'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_FILE_NODES'][0],
      IntentToInputOutput['FIGMA_GET_FILE_NODES'][1]
    >;

    /**
     * Get Rendered Image from File
     * method for FIGMA_GET_RENDERED_IMAGE
     */
    getRenderedImage: (
      inputs: IntentToInputOutput['FIGMA_GET_RENDERED_IMAGE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_RENDERED_IMAGE'][0],
      IntentToInputOutput['FIGMA_GET_RENDERED_IMAGE'][1]
    >;

    /**
     * Get Users' Projects
     * method for FIGMA_GET_PROJECT
     */
    getProject: (
      inputs: IntentToInputOutput['FIGMA_GET_PROJECT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_PROJECT'][0],
      IntentToInputOutput['FIGMA_GET_PROJECT'][1]
    >;

    /**
     * Get Project Files
     * method for FIGMA_GET_PROJECT_FILES
     */
    getProjectFiles: (
      inputs: IntentToInputOutput['FIGMA_GET_PROJECT_FILES'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_PROJECT_FILES'][0],
      IntentToInputOutput['FIGMA_GET_PROJECT_FILES'][1]
    >;

    /**
     * Create Comment
     * method for FIGMA_CREATE_COMMENT
     */
    createComment: (
      inputs: IntentToInputOutput['FIGMA_CREATE_COMMENT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_CREATE_COMMENT'][0],
      IntentToInputOutput['FIGMA_CREATE_COMMENT'][1]
    >;

    /**
     * Get Comments by File
     * method for FIGMA_GET_COMMENTS_BY_FILE
     */
    getCommentsByFile: (
      inputs: IntentToInputOutput['FIGMA_GET_COMMENTS_BY_FILE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_COMMENTS_BY_FILE'][0],
      IntentToInputOutput['FIGMA_GET_COMMENTS_BY_FILE'][1]
    >;

    /**
     * Delete Comment
     * method for FIGMA_DELETE_COMMENTS
     */
    deleteComments: (
      inputs: IntentToInputOutput['FIGMA_DELETE_COMMENTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_DELETE_COMMENTS'][0],
      IntentToInputOutput['FIGMA_DELETE_COMMENTS'][1]
    >;

    /**
     * Create Comment Reaction
     * method for FIGMA_CREATE_COMMENT_REACTION
     */
    createCommentReaction: (
      inputs: IntentToInputOutput['FIGMA_CREATE_COMMENT_REACTION'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_CREATE_COMMENT_REACTION'][0],
      IntentToInputOutput['FIGMA_CREATE_COMMENT_REACTION'][1]
    >;

    /**
     * Get Comment Reactions by File
     * method for FIGMA_GET_COMMENT_REACTION
     */
    getCommentReaction: (
      inputs: IntentToInputOutput['FIGMA_GET_COMMENT_REACTION'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_GET_COMMENT_REACTION'][0],
      IntentToInputOutput['FIGMA_GET_COMMENT_REACTION'][1]
    >;

    /**
     * Delete Comment Reaction
     * method for FIGMA_DELETE_COMMENT_REACTION
     */
    deleteCommentReaction: (
      inputs: IntentToInputOutput['FIGMA_DELETE_COMMENT_REACTION'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['FIGMA_DELETE_COMMENT_REACTION'][0],
      IntentToInputOutput['FIGMA_DELETE_COMMENT_REACTION'][1]
    >;
  };

  /**
   * trigger step methods
   */
  triggers: {};
};
