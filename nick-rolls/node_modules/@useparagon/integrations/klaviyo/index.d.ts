import { ActionStep } from '@useparagon/core';
import {
  CustomDropdownField,
  DynamicMappingField,
} from '@useparagon/core/inputs';
import { IntegrationOptions } from '@useparagon/core/integration';

import { IntentToInputOutput } from './intents';

type IKlaviyoIntegrationUserDefinedInput = {
  id: string;
  title: string;
  required?: boolean;
  tooltip?: string;
} & (
  | {
      type:
        | 'text'
        | 'number'
        | 'email'
        | 'url'
        | 'boolean'
        | 'password'
        | 'list'
        | 'campaign'
        | 'template';
    }
  | {
      type: 'custom_dropdown';
      key: string;
      customDropdownOptions?: CustomDropdownField[];
    }
  | {
      type: 'custom_field_mapping';
      objectName: string;
      // these object types values will be used in preview portal
      mockObjectTypes?: DynamicMappingField[];
      // these integration fields values will be used in preview portal
      mockIntegrationFields?: DynamicMappingField[];
    }
);

/**
 * map b/w input type to result
 */
export type InputResultMap = {
  email: string;
  url: string;
  password: string;
  boolean: boolean;
  text: string;
  number: number;
  custom_dropdown: string;
  custom_field_mapping: {
    object: string;
    fields: Record<string, any>;
  };
  list: string;
  campaign: string;
  template: string;
};

/**
 * pass { variableName for input => Input }
 * this should be used whenever we are creating inputs for integrations/workflows
 * as it will infer proper types
 */
export declare const createInputs: <
  T extends Record<string, IKlaviyoIntegrationUserDefinedInput>,
>(
  inputs: T,
) => T;

/**
 * integration type for klaviyo
 */
export type IKlaviyoIntegration = {
  /**
   * name of integration
   */
  name: string;

  /**
   * action step methods
   */
  actions: {
    /**
     * Create Campaign
     * method for KLAVIYO_CREATE_CAMPAIGN
     */
    createCampaign: (
      inputs: IntentToInputOutput['KLAVIYO_CREATE_CAMPAIGN'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_CREATE_CAMPAIGN'][0],
      IntentToInputOutput['KLAVIYO_CREATE_CAMPAIGN'][1]
    >;

    /**
     * Get Campaigns
     * method for KLAVIYO_GET_CAMPAIGN
     */
    getCampaign: (
      inputs: IntentToInputOutput['KLAVIYO_GET_CAMPAIGN'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_CAMPAIGN'][0],
      IntentToInputOutput['KLAVIYO_GET_CAMPAIGN'][1]
    >;

    /**
     * Send Campaign
     * method for KLAVIYO_SEND_CAMPAIGN
     */
    sendCampaign: (
      inputs: IntentToInputOutput['KLAVIYO_SEND_CAMPAIGN'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_SEND_CAMPAIGN'][0],
      IntentToInputOutput['KLAVIYO_SEND_CAMPAIGN'][1]
    >;

    /**
     * Create List
     * method for KLAVIYO_CREATE_LIST
     */
    createList: (
      inputs: IntentToInputOutput['KLAVIYO_CREATE_LIST'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_CREATE_LIST'][0],
      IntentToInputOutput['KLAVIYO_CREATE_LIST'][1]
    >;

    /**
     * Add subscriber to list
     * method for KLAVIYO_ADD_SUBSCRIBER_TO_LIST
     */
    addSubscriberToList: (
      inputs: IntentToInputOutput['KLAVIYO_ADD_SUBSCRIBER_TO_LIST'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_ADD_SUBSCRIBER_TO_LIST'][0],
      IntentToInputOutput['KLAVIYO_ADD_SUBSCRIBER_TO_LIST'][1]
    >;

    /**
     * Remove Subscriber from list
     * method for KLAVIYO_UNSUBSCRIBE_FROM_LIST
     */
    unsubscribeFromList: (
      inputs: IntentToInputOutput['KLAVIYO_UNSUBSCRIBE_FROM_LIST'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_UNSUBSCRIBE_FROM_LIST'][0],
      IntentToInputOutput['KLAVIYO_UNSUBSCRIBE_FROM_LIST'][1]
    >;

    /**
     * Get Lists
     * method for KLAVIYO_GET_LISTS
     */
    getLists: (
      inputs: IntentToInputOutput['KLAVIYO_GET_LISTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_LISTS'][0],
      IntentToInputOutput['KLAVIYO_GET_LISTS'][1]
    >;

    /**
     * Get List Subscribers
     * method for KLAVIYO_GET_LIST_SUBSCRIBER
     */
    getListSubscriber: (
      inputs: IntentToInputOutput['KLAVIYO_GET_LIST_SUBSCRIBER'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_LIST_SUBSCRIBER'][0],
      IntentToInputOutput['KLAVIYO_GET_LIST_SUBSCRIBER'][1]
    >;

    /**
     * Get Profile
     * method for KLAVIYO_GET_PROFILE
     */
    getProfile: (
      inputs: IntentToInputOutput['KLAVIYO_GET_PROFILE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_PROFILE'][0],
      IntentToInputOutput['KLAVIYO_GET_PROFILE'][1]
    >;

    /**
     * Update Profile
     * method for KLAVIYO_UPDATE_PROFILE
     */
    updateProfile: (
      inputs: IntentToInputOutput['KLAVIYO_UPDATE_PROFILE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_UPDATE_PROFILE'][0],
      IntentToInputOutput['KLAVIYO_UPDATE_PROFILE'][1]
    >;

    /**
     * Create Template
     * method for KLAVIYO_CREATE_TEMPLATE
     */
    createTemplate: (
      inputs: IntentToInputOutput['KLAVIYO_CREATE_TEMPLATE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_CREATE_TEMPLATE'][0],
      IntentToInputOutput['KLAVIYO_CREATE_TEMPLATE'][1]
    >;

    /**
     * Get Templates
     * method for KLAVIYO_GET_TEMPLATES
     */
    getTemplates: (
      inputs: IntentToInputOutput['KLAVIYO_GET_TEMPLATES'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_TEMPLATES'][0],
      IntentToInputOutput['KLAVIYO_GET_TEMPLATES'][1]
    >;

    /**
     * Get Segments
     * method for KLAVIYO_GET_SEGEMENTS
     */
    getSegements: (
      inputs: IntentToInputOutput['KLAVIYO_GET_SEGEMENTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_SEGEMENTS'][0],
      IntentToInputOutput['KLAVIYO_GET_SEGEMENTS'][1]
    >;

    /**
     * Get Segment Subscribers
     * method for KLAVIYO_GET_SEGMENT_SUBSCRIBERS
     */
    getSegmentSubscribers: (
      inputs: IntentToInputOutput['KLAVIYO_GET_SEGMENT_SUBSCRIBERS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['KLAVIYO_GET_SEGMENT_SUBSCRIBERS'][0],
      IntentToInputOutput['KLAVIYO_GET_SEGMENT_SUBSCRIBERS'][1]
    >;
  };

  /**
   * trigger step methods
   */
  triggers: {};
};
