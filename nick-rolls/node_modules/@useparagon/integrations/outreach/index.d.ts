import { ActionStep, ActionTriggerStep } from '@useparagon/core';
import {
  CustomDropdownField,
  DynamicMappingField,
} from '@useparagon/core/inputs';
import { IntegrationOptions } from '@useparagon/core/integration';

import { IntentToInputOutput } from './intents';
import { IntentToInputOutput as TriggerIntentToInputOutput } from './triggers';

type IOutreachIntegrationUserDefinedInput = {
  id: string;
  title: string;
  required?: boolean;
  tooltip?: string;
} & (
  | {
      type:
        | 'text'
        | 'number'
        | 'email'
        | 'url'
        | 'boolean'
        | 'password'
        | 'opportunity_stage'
        | 'sequence';
    }
  | {
      type: 'custom_dropdown';
      key: string;
      customDropdownOptions?: CustomDropdownField[];
    }
  | {
      type: 'custom_field_mapping';
      objectName: string;
      // these object types values will be used in preview portal
      mockObjectTypes?: DynamicMappingField[];
      // these integration fields values will be used in preview portal
      mockIntegrationFields?: DynamicMappingField[];
    }
);

/**
 * map b/w input type to result
 */
export type InputResultMap = {
  email: string;
  url: string;
  password: string;
  boolean: boolean;
  text: string;
  number: number;
  custom_dropdown: string;
  custom_field_mapping: {
    object: string;
    fields: Record<string, any>;
  };
  opportunity_stage: string;
  sequence: string;
};

/**
 * pass { variableName for input => Input }
 * this should be used whenever we are creating inputs for integrations/workflows
 * as it will infer proper types
 */
export declare const createInputs: <
  T extends Record<string, IOutreachIntegrationUserDefinedInput>,
>(
  inputs: T,
) => T;

/**
 * integration type for outreach
 */
export type IOutreachIntegration = {
  /**
   * name of integration
   */
  name: string;

  /**
   * action step methods
   */
  actions: {
    /**
     * Create Account
     * method for OUTREACH_CREATE_ACCOUNT
     */
    createAccount: (
      inputs: IntentToInputOutput['OUTREACH_CREATE_ACCOUNT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_CREATE_ACCOUNT'][0],
      IntentToInputOutput['OUTREACH_CREATE_ACCOUNT'][1]
    >;

    /**
     * Update Account
     * method for OUTREACH_UPDATE_ACCOUNT
     */
    updateAccount: (
      inputs: IntentToInputOutput['OUTREACH_UPDATE_ACCOUNT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_UPDATE_ACCOUNT'][0],
      IntentToInputOutput['OUTREACH_UPDATE_ACCOUNT'][1]
    >;

    /**
     * Get Accounts
     * method for OUTREACH_GET_ACCOUNTS
     */
    getAccounts: (
      inputs: IntentToInputOutput['OUTREACH_GET_ACCOUNTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_GET_ACCOUNTS'][0],
      IntentToInputOutput['OUTREACH_GET_ACCOUNTS'][1]
    >;

    /**
     * Get Account by ID
     * method for OUTREACH_GET_ACCOUNT_BY_ID
     */
    getAccountById: (
      inputs: IntentToInputOutput['OUTREACH_GET_ACCOUNT_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_GET_ACCOUNT_BY_ID'][0],
      IntentToInputOutput['OUTREACH_GET_ACCOUNT_BY_ID'][1]
    >;

    /**
     * Create Opportunity
     * method for OUTREACH_CREATE_OPPORTUNITY
     */
    createOpportunity: (
      inputs: IntentToInputOutput['OUTREACH_CREATE_OPPORTUNITY'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_CREATE_OPPORTUNITY'][0],
      IntentToInputOutput['OUTREACH_CREATE_OPPORTUNITY'][1]
    >;

    /**
     * Update Opportunity
     * method for OUTREACH_UPDATE_OPPORTUNITY
     */
    updateOpportunity: (
      inputs: IntentToInputOutput['OUTREACH_UPDATE_OPPORTUNITY'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_UPDATE_OPPORTUNITY'][0],
      IntentToInputOutput['OUTREACH_UPDATE_OPPORTUNITY'][1]
    >;

    /**
     * Get Opportunities
     * method for OUTREACH_GET_OPPORTUNITIES
     */
    getOpportunities: (
      inputs: IntentToInputOutput['OUTREACH_GET_OPPORTUNITIES'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_GET_OPPORTUNITIES'][0],
      IntentToInputOutput['OUTREACH_GET_OPPORTUNITIES'][1]
    >;

    /**
     * Get Opportunity by ID
     * method for OUTREACH_GET_OPPORTUNITY_BY_ID
     */
    getOpportunityById: (
      inputs: IntentToInputOutput['OUTREACH_GET_OPPORTUNITY_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_GET_OPPORTUNITY_BY_ID'][0],
      IntentToInputOutput['OUTREACH_GET_OPPORTUNITY_BY_ID'][1]
    >;

    /**
     * Create Prospect
     * method for OUTREACH_CREATE_PROSPECT
     */
    createProspect: (
      inputs: IntentToInputOutput['OUTREACH_CREATE_PROSPECT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_CREATE_PROSPECT'][0],
      IntentToInputOutput['OUTREACH_CREATE_PROSPECT'][1]
    >;

    /**
     * Update Prospect
     * method for OUTREACH_UPDATE_PROSPECT
     */
    updateProspect: (
      inputs: IntentToInputOutput['OUTREACH_UPDATE_PROSPECT'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_UPDATE_PROSPECT'][0],
      IntentToInputOutput['OUTREACH_UPDATE_PROSPECT'][1]
    >;

    /**
     * Get Prospects
     * method for OUTREACH_GET_PROSPECTS
     */
    getProspects: (
      inputs: IntentToInputOutput['OUTREACH_GET_PROSPECTS'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_GET_PROSPECTS'][0],
      IntentToInputOutput['OUTREACH_GET_PROSPECTS'][1]
    >;

    /**
     * Get Prospect by ID
     * method for OUTREACH_GET_PROSPECT_BY_ID
     */
    getProspectById: (
      inputs: IntentToInputOutput['OUTREACH_GET_PROSPECT_BY_ID'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_GET_PROSPECT_BY_ID'][0],
      IntentToInputOutput['OUTREACH_GET_PROSPECT_BY_ID'][1]
    >;

    /**
     * Add Prospect to Sequence
     * method for OUTREACH_ADD_PROSPECT_TO_SEQUENCE
     */
    addProspectToSequence: (
      inputs: IntentToInputOutput['OUTREACH_ADD_PROSPECT_TO_SEQUENCE'][0],
      options: IntegrationOptions,
    ) => ActionStep<
      IntentToInputOutput['OUTREACH_ADD_PROSPECT_TO_SEQUENCE'][0],
      IntentToInputOutput['OUTREACH_ADD_PROSPECT_TO_SEQUENCE'][1]
    >;
  };

  /**
   * trigger step methods
   */
  triggers: {
    /**
     * New Account
     * method for OUTREACH_TRIGGER_ACCOUNT_CREATED
     */
    accountCreated: (
      inputs: TriggerIntentToInputOutput['OUTREACH_TRIGGER_ACCOUNT_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_ACCOUNT_CREATED'][0],
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_ACCOUNT_CREATED'][1]
    >;

    /**
     * Account Updated
     * method for OUTREACH_TRIGGER_ACCOUNT_UPDATED
     */
    accountUpdated: (
      inputs: TriggerIntentToInputOutput['OUTREACH_TRIGGER_ACCOUNT_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_ACCOUNT_UPDATED'][0],
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_ACCOUNT_UPDATED'][1]
    >;

    /**
     * New Opportunity
     * method for OUTREACH_TRIGGER_OPPORTUNITY_CREATED
     */
    opportunityCreated: (
      inputs: TriggerIntentToInputOutput['OUTREACH_TRIGGER_OPPORTUNITY_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_OPPORTUNITY_CREATED'][0],
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_OPPORTUNITY_CREATED'][1]
    >;

    /**
     * Opportunity Updated
     * method for OUTREACH_TRIGGER_OPPORTUNITY_UPDATED
     */
    opportunityUpdated: (
      inputs: TriggerIntentToInputOutput['OUTREACH_TRIGGER_OPPORTUNITY_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_OPPORTUNITY_UPDATED'][0],
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_OPPORTUNITY_UPDATED'][1]
    >;

    /**
     * New Prospect
     * method for OUTREACH_TRIGGER_PROSPECT_CREATED
     */
    prospectCreated: (
      inputs: TriggerIntentToInputOutput['OUTREACH_TRIGGER_PROSPECT_CREATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_PROSPECT_CREATED'][0],
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_PROSPECT_CREATED'][1]
    >;

    /**
     * Prospect Updated
     * method for OUTREACH_TRIGGER_PROSPECT_UPDATED
     */
    prospectUpdated: (
      inputs: TriggerIntentToInputOutput['OUTREACH_TRIGGER_PROSPECT_UPDATED'][0],
    ) => ActionTriggerStep<
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_PROSPECT_UPDATED'][0],
      TriggerIntentToInputOutput['OUTREACH_TRIGGER_PROSPECT_UPDATED'][1]
    >;
  };
};
